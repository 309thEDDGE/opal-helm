argoProject: default

namespaces:
  - &minioNS minio-prod
  - &opalNS opal-prod

imagePullSecrets:
  name: regcred
  namespaces:
    - *opalNS
    - *minioNS

useAzureFile: &useAzure false
useAmazonFile: &useAmazon true

gitSyncSecret:
  namespace: *opalNS
  secretName: &gitSyncSecret "git-creds"

tls:
  name: tls-certs
  namespaces:
    - *minioNS
    - *opalNS

oauth:
  name: opal-oauth-common

valuesFile: test-values.yaml

source: &appSource
  url: "https://github.com/309thEDDGE/opal-helm.git"
  targetRevision: "OPAL-1241-full-k8s-onprod"

appValues:
  namespaces:
  - *opalNS 
  - *minioNS 
  source: *appSource
  mongodb:
    enabled: true
    auth:
      enabled: true
      rootUser: rootuser
      rootPassword: ""
      usernames: []
      passwords: []
      databases: []
    replicaCount: 2
  keycloak:
    enabled: true
    namespace: *opalNS
    # bootstrapper admin credentials. User should be disabled after post-install setup
    appValues:
      secrets:
        env:
          stringData:
            KEYCLOAK_ADMIN: "admin"
            KEYCLOAK_ADMIN_PASSWORD: ""
            JAVA_OPTS_APPEND: -Djgroups.dns.query=""
  traefik:
    enabled: true
    appValues:
      namespace: *opalNS
      service:
        annotations:
          # Uncomment for use in AWS
          service.beta.kubernetes.io/aws-load-balancer-type: "external"
          service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: "ip"
          service.beta.kubernetes.io/aws-load-balancer-subnets: subnet-03283225228a37928, subnet-014ea3b6f578bf649
          # uncomment for use in Azure
          # service.beta.kubernetes.io/azure-load-balancer-resource-group: opal-eval_group
          # service.beta.kubernetes.io/azure-pip-name: opal-PIP
          # service.beta.kubernetes.io/azure-dns-label-name: opal-eval
        externalIPs: 
        - 52.222.114.186
      ingress:
        enabled: false
  minioOperator:
    enabled: true
  minioInstance:
    enabled: true
    creds:
      namespace: *minioNS
    secrets:
      accessKey: opal-administrator
    appValues:
      tenant:
        namespace: *minioNS
      oauth:
        existingSecret: "minio-creds-secret"
  nginx:
    enabled: true
    appValues:
      namespace: *opalNS
    restart: always
  jupyterhub:
    enabled: true
    appValues:
      namespace: *opalNS
      resources:
        useAzureFile: *useAzure
        useAmazonFile: *useAmazon
      gitSync:
        enabled: true
        username: ""
        gitSecret:
          secretName: *gitSyncSecret
        image:
          repository: registry.k8s.io/git-sync/git-sync
          tag: v4.0.0
  daskGateway:
    enabled: true
    appValues:
      namespace: *opalNS
